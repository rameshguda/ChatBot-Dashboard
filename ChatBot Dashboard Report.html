<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chatbot Performance Report</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* HeartMath Brand Colors */
        :root {
            --hm-navy: #002855;
            --hm-blue: #009fc2;
            --hm-green: #7ab800;
            --hm-purple: #6a4c93;
            --hm-gray: #f3f4f6;
        }
        body { background-color: var(--hm-gray); font-family: 'Inter', system-ui, sans-serif; color: var(--hm-navy); }
        .hm-card { background: white; border-radius: 0.5rem; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); padding: 1.5rem; border-top: 4px solid var(--hm-navy); }
        .hm-card-metric { border-top-color: var(--hm-blue); }
        
        /* Custom Scrollbar for list */
        .scroller::-webkit-scrollbar { width: 6px; }
        .scroller::-webkit-scrollbar-thumb { background-color: #cbd5e1; border-radius: 4px; }
    </style>
</head>
<body class="p-6 md:p-10 max-w-7xl mx-auto">

    <div class="flex flex-col md:flex-row justify-between items-start md:items-end mb-10 gap-4">
        <div>
            <h1 class="text-3xl font-bold text-hm-navy">Chatbot Performance Report</h1>
            <p class="text-slate-500 mt-2 font-medium">Go-Live Date: <span class="text-hm-blue">Wednesday, Feb 4th, 2026</span></p>
        </div>
        <div class="w-full md:w-auto">
            <label for="dateFilter" class="block text-sm font-bold text-slate-700 mb-1">Select Date Range</label>
            <select id="dateFilter" class="w-full md:w-64 border-2 border-slate-200 rounded-lg px-4 py-2 focus:border-[#009fc2] outline-none font-medium text-slate-600 bg-white shadow-sm transition-all hover:border-blue-300">
                <option value="all">All Time</option>
            </select>
        </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-10">
        <div class="hm-card hm-card-metric flex items-center justify-between transition hover:-translate-y-1 duration-300">
            <div>
                <p class="text-xs font-bold text-slate-400 uppercase tracking-wider">Conversations Handled</p>
                <p class="text-4xl font-extrabold text-hm-navy mt-1">26</p>
            </div>
            <div class="p-3 bg-blue-50 rounded-full text-hm-navy">
                <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"></path></svg>
            </div>
        </div>
        
        <div class="hm-card hm-card-metric flex items-center justify-between transition hover:-translate-y-1 duration-300" style="border-top-color: var(--hm-green);">
            <div>
                <p class="text-xs font-bold text-slate-400 uppercase tracking-wider">Deflection Rate</p>
                <p class="text-4xl font-extrabold text-hm-green mt-1">69%</p>
            </div>
            <div class="p-3 bg-green-50 rounded-full text-hm-green">
                <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
            </div>
        </div>
        
        <div class="hm-card hm-card-metric flex items-center justify-between transition hover:-translate-y-1 duration-300" style="border-top-color: var(--hm-purple);">
            <div>
                <p class="text-xs font-bold text-slate-400 uppercase tracking-wider">Positive Feedback</p>
                <p class="text-4xl font-extrabold text-[#6a4c93] mt-1">26</p>
            </div>
            <div class="p-3 bg-purple-50 rounded-full text-[#6a4c93]">
                <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 10h4.764a2 2 0 011.789 2.894l-3.5 7A2 2 0 0115.263 21h-4.017c-.163 0-.326-.02-.485-.06L7 20m7-10V5a2 2 0 00-2-2h-.095c-.5 0-.905.405-.905.905 0 .714-.211 1.412-.608 2.006L7 11v9m7-10h-2M7 20H5a2 2 0 01-2-2v-6a2 2 0 012-2h2.5"></path></svg>
            </div>
        </div>
    </div>

    <h2 class="text-xl font-bold text-hm-navy mb-4 border-b pb-2">Details</h2>
    
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
        <div class="bg-white p-5 rounded-lg shadow-sm border-l-4 border-slate-400 flex flex-col justify-center">
            <h3 class="text-xs font-bold text-slate-500 uppercase">Sales Inquiries</h3>
            <div class="flex items-baseline gap-2 mt-1">
                <p id="kpi-inquiries" class="text-3xl font-bold text-slate-700">0</p>
                <span class="text-sm text-slate-400">tickets</span>
            </div>
        </div>
        <div class="bg-white p-5 rounded-lg shadow-sm border-l-4 border-[#7ab800] flex flex-col justify-center">
            <h3 class="text-xs font-bold text-slate-500 uppercase">Sales Converted</h3>
            <div class="flex items-baseline gap-2 mt-1">
                <p id="kpi-converted" class="text-3xl font-bold text-[#7ab800]">0</p>
                <span class="text-sm text-slate-400">successful</span>
            </div>
        </div>
        <div class="bg-white p-5 rounded-lg shadow-sm border-l-4 border-[#009fc2] flex flex-col justify-center">
            <h3 class="text-xs font-bold text-slate-500 uppercase">Bot Handling Ratio</h3>
            <div class="flex items-baseline gap-2 mt-1">
                <p id="kpi-handoff" class="text-3xl font-bold text-[#009fc2]">0%</p>
                <span class="text-sm text-slate-400">fully automated</span>
            </div>
        </div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
        <div class="hm-card" id="volumeContainer">
            <div class="flex justify-between items-center mb-4">
                <h3 class="font-bold text-hm-navy">Inquiry Volume Trend</h3>
            </div>
            <div class="relative h-64">
                <canvas id="volumeChart"></canvas>
            </div>
        </div>
        <div class="hm-card">
            <h3 class="font-bold text-hm-navy mb-4">Department Breakdown</h3>
            <div class="relative h-64 flex justify-center">
                <canvas id="deptChart"></canvas>
            </div>
        </div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
        <div class="hm-card lg:col-span-2">
            <h3 class="font-bold text-hm-navy mb-4">Sales Funnel: Product Interest vs. Conversion</h3>
            <div class="relative h-72">
                <canvas id="funnelChart"></canvas>
            </div>
        </div>
        
        <div class="hm-card">
            <h3 class="font-bold text-hm-navy mb-4">Top Inquiry Topics</h3>
            <ul id="topTopics" class="space-y-2 h-72 overflow-y-auto scroller pr-2">
                </ul>
        </div>
    </div>

    <script>
        // Data Parsed from User's Excel Snippets
        const chatBotData = [
          { "desc": "I need to buy emWave2 Charging Cable", "dept": "Sales", "subType": "Charging Cable", "date": "Feb 7, 2026", "owner": "HeartMath Chat", "converted": "Yes" },
          { "desc": "Can I buy and use just the HeartMath ear clip with my phone?", "dept": "Technical Support", "subType": "Ear Sensor", "date": "Feb 7, 2026", "owner": "Ramesh Guda", "converted": "No" },
          { "desc": "I am interested in learning about your Affiliate Program.", "dept": "Sales", "subType": "Other", "date": "Feb 7, 2026", "owner": "HeartMath Chat", "converted": "No" },
          { "desc": "Do you accept HSA", "dept": "Sales", "subType": "Other", "date": "Feb 6, 2026", "owner": "HeartMath Chat", "converted": "No" },
          { "desc": "Need help deciding between HCC and BPR Certification", "dept": "Sales", "subType": "CP Trainings", "date": "Feb 6, 2026", "owner": "HeartMath Chat", "converted": "No" },
          { "desc": "I need information on your training programs", "dept": "Sales", "subType": "CP Trainings", "date": "Feb 6, 2026", "owner": "HeartMath Chat", "converted": "No" },
          { "desc": "How to create a Database in emWave Pro", "dept": "Technical Support", "subType": "emWave Pro", "date": "Feb 6, 2026", "owner": "HeartMath Chat", "converted": "No" },
          { "desc": "How do I reach your Customer Support", "dept": "Customer Service", "subType": "Other", "date": "Feb 6, 2026", "owner": "HeartMath Chat", "converted": "No" },
          { "desc": "Can I get a discount", "dept": "Sales", "subType": "BTLE C-Plus Sensor", "date": "Feb 6, 2026", "owner": "Ramesh Guda", "converted": "No" },
          { "desc": "How much is the emWaveÂ® Pro Plus", "dept": "Sales", "subType": "emWave Pro Plus", "date": "Feb 5, 2026", "owner": "HeartMath Chat", "converted": "No" },
          { "desc": "Interested in BPR Certification", "dept": "Sales", "subType": "CP Trainings", "date": "Feb 5, 2026", "owner": "Ramesh Guda", "converted": "No" },
          { "desc": "Can I get a coupon code?", "dept": "Sales", "subType": "BTLE C-Plus Sensor", "date": "Feb 5, 2026", "owner": "HeartMath Chat", "converted": "No" },
          { "desc": "Can I get a coupon code?", "dept": "Sales", "subType": "BTLE C-Plus Sensor", "date": "Feb 5, 2026", "owner": "HeartMath Chat", "converted": "Yes" },
          { "desc": "Compare C Plus vs Inner Balance Sensors", "dept": "Technical Support", "subType": "BTLE C-Plus Sensor", "date": "Feb 5, 2026", "owner": "HeartMath Chat", "converted": "No" },
          { "desc": "Interested in HCC Program", "dept": "Sales", "subType": "CP Trainings", "date": "Feb 5, 2026", "owner": "Ramesh Guda", "converted": "No" }
        ];

        let charts = {};

        function init() {
            populateDateDropdown();
            renderDashboard('all');

            document.getElementById('dateFilter').addEventListener('change', (e) => {
                renderDashboard(e.target.value);
            });
        }

        function populateDateDropdown() {
            const dropdown = document.getElementById('dateFilter');
            const dates = [...new Set(chatBotData.map(d => d.date))].sort((a,b) => new Date(b) - new Date(a));
            dates.forEach(date => {
                const opt = document.createElement('option');
                opt.value = date;
                opt.textContent = date;
                dropdown.appendChild(opt);
            });
        }

        function renderDashboard(filterDate) {
            const data = filterDate === 'all' ? chatBotData : chatBotData.filter(d => d.date === filterDate);
            
            // Dynamic KPIs
            const salesInquiries = data.filter(d => d.dept === 'Sales').length;
            const salesConverted = data.filter(d => d.dept === 'Sales' && d.converted === 'Yes').length;
            const botInteractions = data.filter(d => d.owner.includes('Chat')).length;
            const botPct = data.length > 0 ? Math.round((botInteractions / data.length) * 100) : 0;

            document.getElementById('kpi-inquiries').textContent = salesInquiries;
            document.getElementById('kpi-converted').textContent = salesConverted;
            document.getElementById('kpi-handoff').textContent = `${botPct}%`;

            renderCharts(data, filterDate);
            renderTopics(data);
        }

        function renderCharts(data, filterDate) {
            // HeartMath Palette
            const colors = { navy: '#002855', blue: '#009fc2', green: '#7ab800', gray: '#cbd5e1', purple: '#6a4c93' };

            // 1. Volume Chart
            const volCtx = document.getElementById('volumeChart');
            if (filterDate !== 'all') {
                document.getElementById('volumeContainer').classList.add('hidden');
            } else {
                document.getElementById('volumeContainer').classList.remove('hidden');
                const volData = data.reduce((acc, curr) => { acc[curr.date] = (acc[curr.date]||0)+1; return acc; }, {});
                
                destroyChart('vol');
                charts['vol'] = new Chart(volCtx, {
                    type: 'bar',
                    data: {
                        labels: Object.keys(volData),
                        datasets: [{ 
                            label: 'Tickets', 
                            data: Object.values(volData), 
                            backgroundColor: colors.navy, 
                            borderRadius: 6,
                            barThickness: 40
                        }]
                    },
                    options: { 
                        responsive: true, 
                        maintainAspectRatio: false, 
                        plugins: { legend: { display: false } },
                        scales: {
                            y: { beginAtZero: true, grid: { borderDash: [2, 4] } },
                            x: { grid: { display: false } }
                        }
                    }
                });
            }

            // 2. Dept Pie
            const deptData = data.reduce((acc, curr) => { acc[curr.dept] = (acc[curr.dept]||0)+1; return acc; }, {});
            destroyChart('dept');
            charts['dept'] = new Chart(document.getElementById('deptChart'), {
                type: 'doughnut',
                data: {
                    labels: Object.keys(deptData),
                    datasets: [{ 
                        data: Object.values(deptData), 
                        backgroundColor: [colors.navy, colors.blue, colors.green, colors.gray],
                        borderWidth: 0
                    }]
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false,
                    plugins: { legend: { position: 'bottom', labels: { usePointStyle: true, boxWidth: 8 } } }
                }
            });

            // 3. Sales Funnel
            const salesData = data.filter(d => d.dept === 'Sales');
            const subTypes = [...new Set(salesData.map(d => d.subType))];
            // Filter out empty subtypes if any
            const cleanSubTypes = subTypes.filter(t => t); 
            
            const inquiries = cleanSubTypes.map(t => salesData.filter(d => d.subType === t).length);
            const converted = cleanSubTypes.map(t => salesData.filter(d => d.subType === t && d.converted === 'Yes').length);

            destroyChart('funnel');
            charts['funnel'] = new Chart(document.getElementById('funnelChart'), {
                type: 'bar',
                data: {
                    labels: cleanSubTypes,
                    datasets: [
                        { label: 'Inquiry', data: inquiries, backgroundColor: colors.gray, barPercentage: 0.6, borderRadius: 4 },
                        { label: 'Converted', data: converted, backgroundColor: colors.green, barPercentage: 0.6, borderRadius: 4 }
                    ]
                },
                options: { 
                    indexAxis: 'y', 
                    responsive: true, 
                    maintainAspectRatio: false,
                    scales: { 
                        x: { stacked: false, grid: { display: false } }, 
                        y: { grid: { display: false } } 
                    },
                    plugins: { legend: { position: 'top', align: 'end' } }
                }
            });
        }

        function renderTopics(data) {
            const list = document.getElementById('topTopics');
            list.innerHTML = '';
            
            // Topic Extraction Logic
            const topicCounts = {};
            data.forEach(d => {
                let key = d.subType;
                // If subType is generic or missing, fall back to description keywords
                if (!key || key === 'Other') {
                    if (d.desc.toLowerCase().includes('certification')) key = 'Certification';
                    else if (d.desc.toLowerCase().includes('discount') || d.desc.toLowerCase().includes('coupon')) key = 'Discount/Coupon';
                    else if (d.desc.toLowerCase().includes('hsa')) key = 'Billing/HSA';
                    else if (d.desc.toLowerCase().includes('support')) key = 'Customer Support';
                    else key = 'General Inquiry';
                }
                topicCounts[key] = (topicCounts[key] || 0) + 1;
            });

            const sorted = Object.entries(topicCounts).sort((a,b) => b[1] - a[1]).slice(0, 5);

            sorted.forEach(([topic, count], i) => {
                const li = document.createElement('li');
                li.className = "flex justify-between items-center p-3 bg-slate-50 rounded border border-slate-100";
                li.innerHTML = `
                    <div class="flex items-center gap-3">
                        <span class="text-xs font-bold text-slate-400">#${i+1}</span>
                        <span class="text-sm font-medium text-slate-700">${topic}</span>
                    </div>
                    <span class="text-xs font-bold text-white bg-[#002855] px-2 py-1 rounded-full">${count}</span>
                `;
                list.appendChild(li);
            });
        }

        function destroyChart(key) {
            if (charts[key]) {
                charts[key].destroy();
                charts[key] = null;
            }
        }

        init();
    </script>
</body>
</html>